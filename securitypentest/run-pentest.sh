#!/usr/bin/env bash
set -e

container="securityscanner"
swagger_target="/local/src/main/resources/swagger/api-docs.yaml"
port="8090"
freport="freport.html"
areport="areport.html"

fscan() {
    docker exec $container zap-full-scan.py -P $port -a -d -t http://localhost:8080 -r $freport && 
    docker ps -a 
    ls -al
    cat $freport
}

sscan() {
    docker start $container
    docker exec securityscanner zap-api-scan.py -P $port -t $swagger_target -f openapi -r $areport
    cat $areport
}

fscan
sscan
